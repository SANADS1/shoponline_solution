@page "/"
@inherits ProductsBase

@if (Products == null)
{
    <DisplaySpinner />
}
else
{
    <h3 class="mb-5">Products</h3>

    var productCount = Products.Count();

    @if (productCount > 0)
    {
       // const int itemsPerRow = 4;
       // var productRowList = new List<ProductDto>();

       // @for (int i = 0; i < productCount; i++)
        //var groupedProductByCategory = from product in Products
           // group product by product.CategoryId
            //into prodByCatGroup
          //  orderby prodByCatGroup.Key
         //   select prodByCatGroup;
        
            //productRowList = Products.Skip(i * itemsPerRow).Take(itemsPerRow).ToList();
            
            
        @foreach (var prodgroup in GetGroupedProductsByCategory())
        {
            <h4>@GetCategoryName(prodgroup)</h4>
                                                                                          
            <div class="row mt-3"><DisplayProducts Products="@prodgroup.Take(4)"></DisplayProducts></div>
            <hr class="mb-3"/>                                                                              
        } 
        
           
        
    }
}